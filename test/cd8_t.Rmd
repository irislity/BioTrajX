---
title: "R Notebook"
---

```{r}
setwd("C:/Users/iris9/BioTrajX")
devtools::load_all() 
```

```{r}
library(Seurat)
seu <- readRDS("C:/Users/iris9/Desktop/GSE164690.all.CD8posT.wScores_pseudotime.rds")
expr <- as.matrix(GetAssayData(seu, layer = "data"))
t<- seu$monocle3_pseudotime
naive<- c("CCR7","TCF7","IL7R")
term<- c('PDCD1','LAG3','HAVCR2','TOX','TIGIT','CTLA4','CXCL13','ENTPD1','ITGAE')
cluster <- seu$functional.cluster

```

```{r}
D <- metrics_D(expr, naive_markers = naive, terminal_markers = term, seu$monocle3_pseudotime)


plot_metrics_D(seu$monocle3_pseudotime,D)
```
```{r}
O <- metrics_O(expr, naive_markers = naive, terminal_markers = term, seu$monocle3_pseudotime)
plot_metrics_O(expr,pseudotime = seu$monocle3_pseudotime, O ,naive_markers = naive, terminal_markers = term)
```
```{r}
P <- metrics_P(expr,
              seu$monocle3_pseudotime,
                      pathways = c("hsa04660","hsa04640"),
                      naive_markers = naive,
                      terminal_markers = term,
                      id_type = c("SYMBOL","ENSEMBL","ENTREZID"),
                      species = "Homo sapiens",
                      assay = NULL,
                      slot  = "data",
                      min_remaining = 10,
                      min_fraction  = 0.20,
                      min_genes_per_module = 3,
                      verbose = TRUE)

plot_metrics_P(expr,seu$monocle3_pseudotime, P)
```
```{r}

```



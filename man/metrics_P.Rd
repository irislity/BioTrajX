% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metric_program.R
\name{metrics_P}
\alias{metrics_P}
\title{P metric: Program coherence along pseudotime (species-aware, fixed for KEGG mapping)}
\usage{
metrics_P(
  expr_or_seurat,
  pseudotime,
  pathways = NULL,
  gene_sets = NULL,
  naive_markers = character(0),
  terminal_markers = character(0),
  id_type = c("SYMBOL", "ENSEMBL", "ENTREZID"),
  species = "Homo sapiens",
  assay = NULL,
  slot = "data",
  min_remaining = 10,
  min_fraction = 0.2,
  min_genes_per_module = 3,
  verbose = TRUE
)
}
\arguments{
\item{expr_or_seurat}{Matrix (genes x cells) \strong{or} a Seurat object.}

\item{pseudotime}{Numeric vector (length = #cells).}

\item{pathways}{Character vector of KEGG queries (e.g. "mmu04640").}

\item{gene_sets}{Named list of character vectors (modules).}

\item{naive_markers, terminal_markers}{Character vectors of marker IDs to exclude.}

\item{id_type}{One of c("SYMBOL","ENSEMBL","ENTREZID").}

\item{species}{Species common name (e.g., "Mus musculus").}

\item{assay, slot}{Seurat assay/slot.}

\item{min_remaining, min_fraction, min_genes_per_module}{Filtering controls.}

\item{verbose}{Logical.}
}
\value{
List with P metric results.
}
\description{
Compute the Program (P) metric by fitting GAMs of module (gene set) z-scores
against pseudotime and aggregating explained variance (R^2) across modules.
Gene sets can come from user input (\code{gene_sets}) or from MSigDB KEGG via
\code{msigdbr} given \code{pathways}. Supports Seurat or matrix input. Species-aware
ID mapping via the appropriate Bioconductor OrgDb.
}

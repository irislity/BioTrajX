% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/doe_wrapper.R
\name{compute_single_DOE_linear}
\alias{compute_single_DOE_linear}
\title{Compute DOE metrics for a single trajectory (linear)}
\usage{
compute_single_DOE_linear(
  expr_or_seurat,
  pseudotime,
  naive_markers,
  terminal_markers,
  cluster_labels = NULL,
  naive_clusters = NULL,
  terminal_clusters = NULL,
  E_method = c("gmm", "clusters", "combined"),
  assay = NULL,
  slot = "data",
  plot_E = TRUE,
  verbose = FALSE,
  branch_include = NULL,
  branch_exclude = NULL,
  branch_min_cells = 10,
  drop_unused_levels = TRUE,
  tol = 1e-08
)
}
\arguments{
\item{expr_or_seurat}{A Seurat object, numeric matrix, \code{dgCMatrix}, or
\code{data.frame} of gene expression (genes x cells).}

\item{pseudotime}{Numeric vector of length equal to the number of cells after
any subsetting; names should be cell IDs. If unnamed, it must be in the
same order as the columns of \code{expr_or_seurat}.}

\item{naive_markers}{Character vector of gene symbols/IDs expected to be high
in the naïve/early state.}

\item{terminal_markers}{Character vector of gene symbols/IDs expected to be
high in the terminal/late state.}

\item{cluster_labels}{Either (i) a per-cell vector (same length/order as
cells) giving cluster/branch labels, or (ii) \strong{for Seurat inputs only}, a
single character string giving the name of a metadata column to use.}

\item{naive_clusters}{Character vector of cluster names defining naïve
clusters for \code{E} when \code{E_method \%in\% c("clusters","combined")}.}

\item{terminal_clusters}{Character vector of cluster names defining terminal
clusters for \code{E} when \code{E_method \%in\% c("clusters","combined")}.}

\item{E_method}{One of \code{"gmm"}, \code{"clusters"}, or \code{"combined"}. Controls how
endpoint validity is estimated inside \code{metrics_E()}.}

\item{assay}{Assay name to pull from a Seurat object (defaults to
\code{Seurat::DefaultAssay(x)} when \code{NULL}).}

\item{slot}{Slot to pull from a Seurat assay; typically \code{"data"} (default),
\code{"counts"}, or \code{"scale.data"}.}

\item{plot_E}{Logical; if \code{TRUE}, allow \code{metrics_E()} to produce diagnostic
density plots when using the GMM mode (default \code{TRUE}).}

\item{verbose}{Logical; if \code{TRUE}, print diagnostic messages when component
metrics fail and are caught (default \code{FALSE}).}

\item{drop_unused_levels}{Logical; if \code{TRUE}, drop unused factor levels in
the subsetted cluster labels (default \code{TRUE}).}
}
\value{
An object of class \code{"doe_results"}, a list with elements:
\describe{
\item{$D$}{List with \code{D_naive}, \code{D_term}.}
\item{$O$}{List with scalar \code{O}.}
\item{$E$}{List with \code{E_naive}, \code{E_term}, and composite \code{E_comp}.}
\item{$DOE_score$}{Scalar mean over available component scores.}
\item{$errors$}{List of caught error messages for D/O/E (may be \code{NULL}).}
}
}
\description{
High-level convenience wrapper that computes the DOE components—
Directionality (D), Order consistency (O), and
Endpoints validity (E)—for a single trajectory. Works with either a
\strong{Seurat} object (pulling assay data via \code{GetAssayData}) or an expression
matrix-like input (dense \code{matrix}, \code{dgCMatrix}, or \code{data.frame} with genes in
rows and cells in columns). Optionally handles \strong{branched} trajectories by
subsetting a specified branch before scoring.
}
\details{
The wrapper:
\itemize{
\item Aligns \code{pseudotime} (and \code{cluster_labels} when provided) to the
current cell order.
\item Optionally subsets to a specified branch for \code{"branched"} trajectories.
\item Computes D via \code{metrics_D()}, O via \code{metrics_O()},
and E via \code{metrics_E()} (controlled by \code{E_method}, \code{plot_E}, and
optional cluster specification).
\item Aggregates a scalar \code{DOE_score} as the mean of available component
scores (ignoring \code{NA}s).
}

Component failures are caught; the corresponding entry is set to \code{NA} and the
error message is recorded under \code{errors}. Per-cell naïve/terminal scores used
by \code{E} are computed internally as mean expression over the provided marker
sets.
}
\note{
This wrapper relies on the availability and behavior of the helper functions
\code{metrics_D()}, \code{metrics_O()}, and \code{metrics_E()}, as well as
optional plotting utilities (e.g. \verb{plot_metrics_*}). Ensure these are loaded
in your package namespace. If working with Seurat inputs, the \strong{Seurat}
package must be installed and the requested assay/slot must exist.
}
\examples{
\dontrun{

res <- compute_single_DOE_linear(
  expr_or_seurat   = expr,
  pseudotime       = pt,
  naive_markers    = naive,
  terminal_markers = term,
  E_method         = "gmm",
  species          = "Homo sapiens"
)
str(res)

}
}
\seealso{
\code{metrics_D()}, \code{metrics_O()}, \code{metrics_E()},
\code{subset_by_clusters()}
}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dope_wrapper.R
\name{compute_multi_DOPE_linear}
\alias{compute_multi_DOPE_linear}
\title{Compute DOPE metrics for multiple linear trajectories}
\usage{
compute_multi_DOPE_linear(
  expr_or_seurat,
  pseudotime_list,
  naive_markers,
  terminal_markers,
  cluster_labels = NULL,
  naive_clusters = NULL,
  terminal_clusters = NULL,
  pathways = NULL,
  gene_sets = NULL,
  E_method = c("gmm", "clusters", "combined"),
  id_type = c("SYMBOL", "ENSEMBL", "ENTREZID"),
  species = "Homo sapiens",
  assay = NULL,
  slot = "data",
  min_remaining = 10,
  min_fraction = 0.2,
  min_genes_per_module = 3,
  plot_E = TRUE,
  verbose = TRUE,
  parallel = FALSE,
  n_cores = NULL,
  branch_include = NULL,
  branch_exclude = NULL,
  branch_min_cells = 10,
  drop_unused_levels = TRUE,
  tol = 1e-08
)
}
\arguments{
\item{expr_or_seurat}{A gene expression matrix (genes × cells),
a \code{dgCMatrix}, a \code{data.frame} (coerced to matrix), or a Seurat object.
If Seurat, \code{assay} and \code{slot} control which assay/slot is used.}

\item{pseudotime_list}{A named or unnamed \strong{list} of numeric pseudotime
vectors (one per trajectory). Each vector must have length equal to the
number of columns/cells of \code{expr_or_seurat} (after extraction).}

\item{naive_markers}{Character vector of gene symbols/IDs for naïve/early
programs (used by D/O/E/P as relevant).}

\item{terminal_markers}{Character vector of gene symbols/IDs for terminal/late
programs.}

\item{cluster_labels}{Optional character/factor vector of cluster labels
(one per cell) used by E (when \code{E_method = "clusters"} or \code{"combined"}).}

\item{naive_clusters}{Optional character vector of cluster names considered
naïve (E Case 2 / cluster-based).}

\item{terminal_clusters}{Optional character vector of cluster names considered
terminal (E Case 2 / cluster-based).}

\item{pathways}{Optional list of pathway name → gene vector (used by P).}

\item{gene_sets}{Optional list of additional gene sets name → gene vector
(also used by P).}

\item{E_method}{Endpoints validity method. One of \code{"gmm"}, \code{"clusters"},
or \code{"combined"}. See \code{\link[=compute_single_DOPE_linear]{compute_single_DOPE_linear()}} for details.}

\item{id_type}{Gene identifier type for markers/pathways. One of
\code{"SYMBOL"}, \code{"ENSEMBL"}, or \code{"ENTREZID"}.}

\item{species}{Species name used for ID mapping (e.g., \code{"Homo sapiens"}).}

\item{assay}{If \code{expr_or_seurat} is a Seurat object, the assay to use.
If \code{NULL}, defaults to \code{Seurat::DefaultAssay()}.}

\item{slot}{If \code{expr_or_seurat} is a Seurat object, the assay slot to
extract (e.g., \code{"data"}, \code{"counts"}). Default \code{"data"}.}

\item{min_remaining}{Minimum number of genes to retain after filtering
within sub-steps (safety check).}

\item{min_fraction}{Minimum retained fraction of genes after filtering
(safety check).}

\item{min_genes_per_module}{Minimum number of genes required per program/
module to compute stable scores.}

\item{plot_E}{Logical; if \code{TRUE}, produce diagnostic density plots when
\code{E_method} uses GMM.}

\item{verbose}{Logical; print progress.}

\item{parallel}{Logical; if \code{TRUE} and multiple trajectories are provided,
use \strong{parallel} workers.}

\item{n_cores}{Integer number of cores. If \code{NULL}, uses \code{detectCores()-1}.}

\item{drop_unused_levels}{Logical; drop unused factor levels (where relevant).}

\item{tol}{Numerical tolerance for internal numerical checks.}
}
\value{
An object of class \code{"multi_dope_results"} with components:
\itemize{
\item \code{results}: named list of per-trajectory DOPE results
(each as returned by \code{compute_single_DOPE_linear()}).
\item \code{comparison_summary}: \code{data.frame} summarizing
D/O/P/E and \code{DOPE_score} per trajectory.
\item \code{best_trajectory}: character scalar with the name of the
highest-scoring trajectory (or \code{NA} if none valid).
\item \code{n_trajectories}: integer count.
\item \code{method_info}: list of key settings used.
}
}
\description{
Runs the full DOPE pipeline (Directionality \strong{D}, Order consistency \strong{O},
Program coherence \strong{P}, Endpoints validity \strong{E}, and the combined
\code{DOPE_score}) across \strong{multiple linear} pseudotime vectors sharing the
same expression object. Results are collected per trajectory and summarized
in a comparison table with the best trajectory highlighted.
}
\details{
This function is a convenience wrapper that repeatedly calls
\code{\link[=compute_single_DOPE_linear]{compute_single_DOPE_linear()}} for each linear trajectory provided in
\code{pseudotime_list}. It supports optional parallelization via the
\strong{parallel} package (fork/PSOCK, depending on platform).

If \code{pseudotime_list} is unnamed, trajectories are auto-named as
\code{"trajectory_1"}, \code{"trajectory_2"}, etc.
}
\examples{
\dontrun{
# expr: genes x cells matrix; pt1, pt2: numeric pseudotime vectors (length = ncol(expr))
res <- compute_multi_DOPE_linear(
  expr_or_seurat = expr,
  pseudotime_list = list(linear_a = pt1, linear_b = pt2),
  naive_markers = c("TCF7","LEF1"),
  terminal_markers = c("GZMB","PRF1"),
  E_method = "combined",
  parallel = TRUE
)
res$comparison_summary
res$best_trajectory
}

}
\seealso{
\code{\link[=compute_single_DOPE_linear]{compute_single_DOPE_linear()}}, plotting helpers like
\code{plot.multi_dope_results()}.
}
